<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/categoryPane.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/categoryPane.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
    Copyright (C) 2014-2015, THE PANACEA PROJECTS &lt;panacier@gmail.com>

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software Foundation,
    Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA
*/

const Lang = imports.lang;
const St = imports.gi.St;

const Me = imports.misc.extensionUtils.getCurrentExtension();
const Log = Me.imports.scripts.misc.log;
const Component = Me.imports.scripts.menu.components.component.Component;
const MenuModel = Me.imports.scripts.menu.menuModel;
const TextToggleButton = Me.imports.scripts.menu.components.elements.menubutton.TextToggleButton;
const ButtonGroup = Me.imports.scripts.menu.components.elements.menubutton.ButtonGroup;

const ECategoryID = MenuModel.ECategoryID;
const ECategoryDescriptionID = MenuModel.ECategoryDescriptionID;

/**
 * Simple Enum which provides a mousebutton to id mapping.
 * @private
 */
const MOUSEBUTTON = Me.imports.scripts.menu.components.elements.menubutton.EMousebutton;


/**
 * @class CategoryPane
 * @extends Component
 * 
 * @classdesc This class creates a small pane with category buttons. It
 *            contains toggle buttons that show which category is active. You
 *            can also set the selected category programmatically. If you
 *            provide an valid id the corresponding category is selected, if
 *            not no category is selected. It is possible to refresh this
 *            component. This triggers a complete rebuild of the component
 *            which is probably not needed very often. It is possible to add
 *            the actor of this class to a normal boxlayout.
 * 
 * @description You need to provide valid instances of model and mediator. The
 *              model is needed to receive current data which then is displayed.
 *              The mediator is used to interact with the other components of
 *              the menu. So it is not allowed to call the methods of any other
 *              component directly.
 *
 *
 * @param {MenuModel} model A model instance.
 * @param {MenuMediator} mediator A mediator instance.
 *
 * @property {Clutter.Actor} actor The clutter actor of this component.
 *
 *
 * @author AxP &lt;Der_AxP@t-online.de>
 * @author passingthru67 &lt;panacier@gmail.com>
 * @version 1.0
 */
const CategoryPane = new Lang.Class({

    Name: 'Gnomenu.CategoryPane',
    Extends: Component,


    _init: function(model, mediator) {
        this.parent(model, mediator);

        // The buttons are in a buttongroup so it would be no problem to
        // implement keyboard controls.
        this.actor = new St.BoxLayout({ style_class: 'gnomenu-categorypanel-box' });
        this._buttonGroup = new ButtonGroup();

        this.refresh();
    },

    /**
     * @description Use this function to bring the view to a fresh state. This
     *              recreates the component completely.
     * @function
     * @memberof CategoryPane#
     */
    refresh: function() {
        this.clear();

        // Creates the recent category button.
        let recentCategoryBtn = new TextToggleButton(this.mediator, ECategoryID.RECENTFILES, ECategoryID.RECENTFILES, ECategoryDescriptionID.RECENTFILES);
        recentCategoryBtn.setID(ECategoryID.RECENTFILES);
        recentCategoryBtn.setHandlerForButton(MOUSEBUTTON.MOUSE_LEFT, this._getCallback(ECategoryID.RECENTFILES));

        // Creates the web category button.
        let webBookmarksCategoryBtn = new TextToggleButton(this.mediator, ECategoryID.WEB, ECategoryID.WEB, ECategoryDescriptionID.WEB);
        webBookmarksCategoryBtn.setID(ECategoryID.WEB);
        webBookmarksCategoryBtn.setHandlerForButton(MOUSEBUTTON.MOUSE_LEFT, this._getCallback(ECategoryID.WEB));

        // Creates either the favorites category or the places category button.
        let tmpCategoryBtn = null;
        switch (this.menuSettings.getSidebarCategory()) {

            case ECategoryID.FAVORITES:
                tmpCategoryBtn = new TextToggleButton(this.mediator, ECategoryID.PLACES, ECategoryID.PLACES, ECategoryDescriptionID.PLACES);
                tmpCategoryBtn.setID(ECategoryID.PLACES);
                tmpCategoryBtn.setHandlerForButton(MOUSEBUTTON.MOUSE_LEFT, this._getCallback(ECategoryID.PLACES));
                break;

            case ECategoryID.PLACES:
                tmpCategoryBtn = new TextToggleButton(this.mediator, ECategoryID.FAVORITES, ECategoryID.FAVORITES, ECategoryDescriptionID.FAVORITES);
                tmpCategoryBtn.setID(ECategoryID.FAVORITES);
                tmpCategoryBtn.setHandlerForButton(MOUSEBUTTON.MOUSE_LEFT, this._getCallback(ECategoryID.FAVORITES));
                break;

            default:
                break;
        }

        // The buttongroup handles the interaction between the buttons.
        this._buttonGroup.addButton(recentCategoryBtn);
        this._buttonGroup.addButton(webBookmarksCategoryBtn);
        this._buttonGroup.addButton(tmpCategoryBtn);

        this.actor.add(recentCategoryBtn.actor,       { expand: true, x_fill: true, y_fill: false, x_align: St.Align.MIDDLE, y_align: St.Align.MIDDLE });
        this.actor.add(webBookmarksCategoryBtn.actor, { expand: true, x_fill: true, y_fill: false, x_align: St.Align.MIDDLE, y_align: St.Align.MIDDLE });
        this.actor.add(tmpCategoryBtn.actor,          { expand: true, x_fill: true, y_fill: false, x_align: St.Align.MIDDLE, y_align: St.Align.MIDDLE });
    },

    /**
     * @description This function returns the callback for the buttons.
     * @param {StringEnum} categoryID The enum string that is used as id. @see MenuModel
     * @returns {Callback} A callback that triggers a category change.
     * @private
     * @function
     * @memberof CategoryPane#
     */
    _getCallback: function(categoryID) {
        return Lang.bind(this, function(isSelected) {
            // If the button is deselected then the default category is applied.
            let cat = this.menuSettings.getDefaultShortcutAreaCategory();
            if (isSelected) {
                cat = categoryID;
            }
            // The mediator is notified that a category changed.
            this.mediator.notifyCategoryChange(cat);

            return true;
        });
    },

    /**
     * @description Use this function to remove all actors from the component.
     *              After this call the actor is empty and the date got
     *              deleted.
     * @function
     * @memberof CategoryPane#
     */
    clear: function() {
        let actors = this.actor.get_children();
        if (actors) {
            for each (let actor in actors) {
                this.actor.remove_actor(actor);
                // We dont need the buttons anymore so they can be destroyed.
                actor.destroy();
            }
        }
        // The buttongroup is now empty again.
        this._buttonGroup.reset();
    },

    /**
     * @description Use this function to destroy the component.
     * @function
     * @memberof CategoryPane#
     */
    destroy: function() {
        this.clear();
        this.actor.destroy();
    },

    /**
     * @description Use this function to select a button by category ID. You
     *              may provide wrong or unregistered ids to spare an
     *              extra check. In this case no button is selected and all
     *              are after this deselected.
     * @param {StringEnum} categoryID The category id that the button handles.
     * @function
     * @memberof CategoryPane#
     */
    selectCategory: function(categoryID) {
        // For this to work the buttons need to have their category id.
        this._buttonGroup.selectByID(categoryID);
    },

    /**
     * @description Use this function to deselect all buttons.
     * @function
     * @memberof CategoryPane#
     */
    deselectButtons: function() {
        this._buttonGroup.clearButtonStates();
    },
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Button.html">Button</a></li><li><a href="ButtonGroup.html">ButtonGroup</a></li><li><a href="CategoryBox.html">CategoryBox</a></li><li><a href="CategoryPane.html">CategoryPane</a></li><li><a href="Component.html">Component</a></li><li><a href="ControlPane.html">ControlPane</a></li><li><a href="DescriptionBox.html">DescriptionBox</a></li><li><a href="DraggableButton.html">DraggableButton</a></li><li><a href="DraggableGridButton.html">DraggableGridButton</a></li><li><a href="DraggableIconButton.html">DraggableIconButton</a></li><li><a href="DraggableListButton.html">DraggableListButton</a></li><li><a href="IconButton.html">IconButton</a></li><li><a href="IconToggleButton.html">IconToggleButton</a></li><li><a href="InternalButton.html">InternalButton</a></li><li><a href="MainArea.html">MainArea</a></li><li><a href="Menu.html">Menu</a></li><li><a href="MenuMediator.html">MenuMediator</a></li><li><a href="MenuModel.html">MenuModel</a></li><li><a href="MenuSearch.html">MenuSearch</a></li><li><a href="MenuSettings.html">MenuSettings</a></li><li><a href="ModelObserver.html">ModelObserver</a></li><li><a href="NavigationArea.html">NavigationArea</a></li><li><a href="NavigationBox.html">NavigationBox</a></li><li><a href="PreferencesButton.html">PreferencesButton</a></li><li><a href="ProviderResultBoxBase.html">ProviderResultBoxBase</a></li><li><a href="ProviderResultBoxButton.html">ProviderResultBoxButton</a></li><li><a href="ProviderResultGrid.html">ProviderResultGrid</a></li><li><a href="ProviderResultList.html">ProviderResultList</a></li><li><a href="ResultArea.html">ResultArea</a></li><li><a href="SearchField.html">SearchField</a></li><li><a href="ShortcutArea.html">ShortcutArea</a></li><li><a href="ShortcutBoxBase.html">ShortcutBoxBase</a></li><li><a href="ShortcutGrid.html">ShortcutGrid</a></li><li><a href="ShortcutList.html">ShortcutList</a></li><li><a href="Sidebar.html">Sidebar</a></li><li><a href="TextButton.html">TextButton</a></li><li><a href="TextToggleButton.html">TextToggleButton</a></li><li><a href="ToggleButton.html">ToggleButton</a></li><li><a href="UpdateableComponent.html">UpdateableComponent</a></li><li><a href="ViewModePane.html">ViewModePane</a></li><li><a href="WorkspaceBox.html">WorkspaceBox</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ECategoryDescriptionID">ECategoryDescriptionID</a></li><li><a href="global.html#ECategoryID">ECategoryID</a></li><li><a href="global.html#ECategoryNum">ECategoryNum</a></li><li><a href="global.html#EEventType">EEventType</a></li><li><a href="global.html#EMenuLayout">EMenuLayout</a></li><li><a href="global.html#EMousebutton">EMousebutton</a></li><li><a href="global.html#ESelectionMethod">ESelectionMethod</a></li><li><a href="global.html#EViewMode">EViewMode</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-dev</a> on Wed Nov 26 2014 15:05:45 GMT+0100 (MEZ)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
